@import 'tailwindcss';
@plugin '@tailwindcss/forms';
@plugin '@tailwindcss/typography';
@source '../node_modules/pliny';
@custom-variant dark (&:where(.dark, .dark *));

/* Core theme configuration */
@theme {
  /* Font families */
  --font-sans:
    var(--font-space-grotesk), ui-sans-serif, system-ui, sans-serif, 'Apple Color Emoji',
    'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';

  --animate-spin: spin 500ms ease-in-out forwards;
  --animate-fade-in: fadeIn 0.6s ease-out forwards;
  --animate-slide-up: slideUp 0.6s ease-out forwards;
  --animate-slide-in-right: slideInRight 0.6s ease-out forwards;
  --animate-float: float 6s ease-in-out infinite;
  --animate-pulse-slow: pulse 4s cubic-bezier(0.4, 0, 0.6, 1) infinite;
  --animate-gradient: gradient 8s linear infinite;
  --animate-glow: glow 2s ease-in-out infinite alternate;

  /* Sophisticated developer-focused color palette - Refined blue-slate theme */
  --color-primary-50: oklch(0.98 0.008 240);
  --color-primary-100: oklch(0.96 0.012 240);
  --color-primary-200: oklch(0.92 0.022 240);
  --color-primary-300: oklch(0.84 0.042 240);
  --color-primary-400: oklch(0.72 0.082 240);
  --color-primary-500: oklch(0.60 0.118 240);
  --color-primary-600: oklch(0.50 0.125 240);
  --color-primary-700: oklch(0.42 0.112 240);
  --color-primary-800: oklch(0.32 0.088 240);
  --color-primary-900: oklch(0.24 0.065 240);
  --color-primary-950: oklch(0.16 0.042 240);

  /* Refined accent colors - minimal usage, sophisticated tones */
  --color-accent-blue: oklch(0.64 0.15 245);
  --color-accent-teal: oklch(0.68 0.11 200);
  --color-accent-amber: oklch(0.75 0.14 65);

  --color-gray-50: oklch(0.985 0.002 247.839);
  --color-gray-100: oklch(0.967 0.003 264.542);
  --color-gray-200: oklch(0.928 0.006 264.531);
  --color-gray-300: oklch(0.872 0.01 258.338);
  --color-gray-400: oklch(0.707 0.022 261.325);
  --color-gray-500: oklch(0.551 0.027 264.364);
  --color-gray-600: oklch(0.446 0.03 256.802);
  --color-gray-700: oklch(0.373 0.034 259.733);
  --color-gray-800: oklch(0.278 0.033 256.848);
  --color-gray-900: oklch(0.21 0.034 264.665);
  --color-gray-950: oklch(0.13 0.028 261.692);

  /* Line heights */
  --line-height-11: 2.75rem;
  --line-height-12: 3rem;
  --line-height-13: 3.25rem;
  --line-height-14: 3.5rem;

  /* Z-index values */
  --z-60: 60;
  --z-70: 70;
  --z-80: 80;
}

/* Keyframe animations - optimized for GPU acceleration using transform and opacity only */
@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(10px) translateZ(0);
  }
  to {
    opacity: 1;
    transform: translateY(0) translateZ(0);
  }
}

@keyframes slideUp {
  from {
    opacity: 0;
    transform: translateY(30px) translateZ(0);
  }
  to {
    opacity: 1;
    transform: translateY(0) translateZ(0);
  }
}

@keyframes slideInRight {
  from {
    opacity: 0;
    transform: translateX(30px) translateZ(0);
  }
  to {
    opacity: 1;
    transform: translateX(0) translateZ(0);
  }
}

@keyframes float {
  0%,
  100% {
    transform: translateY(0px) translateZ(0);
  }
  50% {
    transform: translateY(-20px) translateZ(0);
  }
}

@keyframes gradient {
  0% {
    background-position: 0% 50%;
  }
  50% {
    background-position: 100% 50%;
  }
  100% {
    background-position: 0% 50%;
  }
}

@keyframes glow {
  from {
    box-shadow: 0 0 20px -10px var(--color-primary-500);
  }
  to {
    box-shadow: 0 0 30px -10px var(--color-primary-400);
  }
}

@keyframes typewriter {
  from {
    width: 0;
  }
  to {
    width: 100%;
  }
}

@keyframes blink {
  50% {
    border-color: transparent;
  }
}

@keyframes progressAnimation {
  from {
    stroke-dashoffset: 100;
  }
  to {
    stroke-dashoffset: var(--progress-offset, 0);
  }
}

/*
  The default border color has changed to `currentColor` in Tailwind CSS v4,
  so we've added these compatibility styles to make sure everything still
  looks the same as it did with Tailwind CSS v3.

  If we ever want to remove these styles, we need to add an explicit border
  color utility to any element that depends on these defaults.
*/
@layer base {
  *,
  ::after,
  ::before,
  ::backdrop,
  ::file-selector-button {
    border-color: var(--color-gray-200, currentColor);
  }

  :root input[aria-controls='kbar-listbox'][role='combobox'] {
    border: 1px solid var(--color-gray-300);
    border-radius: 0.5rem; /* optional: match your rounded-lg vibe */
  }

  :root input[aria-controls='kbar-listbox'][role='combobox']:focus {
    border-color: var(--color-primary-500);
    outline: none;
  }

  a,
  button {
    outline-color: var(--color-primary-500);
  }

  a:focus-visible,
  button:focus-visible,
  input:focus-visible,
  select:focus-visible,
  textarea:focus-visible {
    outline: 3px solid var(--color-primary-500);
    outline-offset: 2px;
    border-radius: var(--radius-sm);
  }

  /* Ensure focus ring is visible on dark backgrounds */
  .dark a:focus-visible,
  .dark button:focus-visible,
  .dark input:focus-visible,
  .dark select:focus-visible,
  .dark textarea:focus-visible {
    outline-color: var(--color-primary-400);
  }

  /* Override default input focus styles to use primary colors */
  input:focus,
  select:focus,
  textarea:focus {
    border-color: var(--color-primary-500);
    ring-color: var(--color-primary-500);
    --tw-ring-color: var(--color-primary-500);
  }

  .dark input:focus,
  .dark select:focus,
  .dark textarea:focus {
    border-color: var(--color-primary-400);
    ring-color: var(--color-primary-400);
    --tw-ring-color: var(--color-primary-400);
  }

  /* Smooth scrolling for the entire page */
  html {
    scroll-behavior: smooth;
  }

  /* Custom selection colors */
  ::selection {
    background-color: var(--color-primary-200);
    color: var(--color-primary-900);
  }

  .dark ::selection {
    background-color: var(--color-primary-800);
    color: var(--color-primary-100);
  }
}

@layer utilities {
  .prose {
    & a {
      color: var(--color-primary-500);
      text-decoration: none;
      border-bottom: 1px solid transparent;
      transition: all 0.2s ease;
      &:hover {
        color: var(--color-primary-600);
        border-bottom-color: var(--color-primary-600);
      }
      & code {
        color: var(--color-primary-400);
      }
    }
    & :where(h1, h2) {
      font-weight: 700;
      letter-spacing: var(--tracking-tight);
    }
    & h3 {
      font-weight: 600;
    }
    & :where(code):not(pre code) {
      color: var(--color-primary-500);
    }
  }

  .prose-invert {
    & a {
      color: var(--color-primary-500);
      &:hover {
        color: var(--color-primary-400);
        border-bottom-color: var(--color-primary-400);
      }
      & code {
        color: var(--color-primary-400);
      }
    }
    & :where(h1, h2, h3, h4, h5, h6) {
      color: var(--color-gray-100);
    }
  }

  /* Subtle gradient text utility - minimal, sophisticated */
  .gradient-text {
    background: linear-gradient(
      135deg,
      var(--color-primary-600) 0%,
      var(--color-primary-500) 50%,
      var(--color-accent-blue) 100%
    );
    -webkit-background-clip: text;
    background-clip: text;
    -webkit-text-fill-color: transparent;
  }

  /* Glassmorphism effect */
  .glass {
    background: rgba(255, 255, 255, 0.7);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.2);
  }

  .dark .glass {
    background: rgba(15, 23, 42, 0.7);
    border: 1px solid rgba(255, 255, 255, 0.1);
  }

  /* Hover lift effect - optimized for GPU acceleration */
  .hover-lift {
    transition:
      transform 0.3s ease,
      box-shadow 0.3s ease;
    will-change: transform;
  }

  .hover-lift:hover {
    transform: translateY(-5px) translateZ(0);
    box-shadow:
      0 20px 25px -5px rgba(0, 0, 0, 0.1),
      0 10px 10px -5px rgba(0, 0, 0, 0.04);
  }

  .dark .hover-lift:hover {
    box-shadow:
      0 20px 25px -5px rgba(0, 0, 0, 0.4),
      0 10px 10px -5px rgba(0, 0, 0, 0.2);
  }

  /* Animated underline */
  .animated-underline {
    position: relative;
    text-decoration: none;
    display: inline-block;
  }

  .animated-underline::after {
    content: '';
    position: absolute;
    width: 0;
    height: 2px;
    bottom: -2px;
    left: 0;
    background: var(--color-primary-500);
    transition: width 0.3s ease;
  }

  .animated-underline:hover::after {
    width: 100%;
  }

  /* Glow button effect */
  .glow-button {
    position: relative;
    overflow: hidden;
    transition: all 0.3s ease;
  }

  .glow-button::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
    transition: left 0.5s ease;
  }

  .glow-button:hover::before {
    left: 100%;
  }

  /* Gradient border */
  .gradient-border {
    position: relative;
    background: white;
    z-index: 1;
  }

  .gradient-border::before {
    content: '';
    position: absolute;
    inset: 0;
    padding: 1px;
    border-radius: inherit;
    background: linear-gradient(135deg, var(--color-primary-400), var(--color-primary-600));
    -webkit-mask:
      linear-gradient(#fff 0 0) content-box,
      linear-gradient(#fff 0 0);
    mask:
      linear-gradient(#fff 0 0) content-box,
      linear-gradient(#fff 0 0);
    -webkit-mask-composite: xor;
    mask-composite: exclude;
    z-index: -1;
  }

  .dark .gradient-border {
    background: var(--color-gray-950);
  }

  /* Dot pattern background */
  .dot-pattern {
    background-image: radial-gradient(var(--color-gray-300) 1px, transparent 1px);
    background-size: 20px 20px;
  }

  .dark .dot-pattern {
    background-image: radial-gradient(var(--color-gray-700) 1px, transparent 1px);
  }

  /* Subtle mesh gradient background - minimal usage */
  .mesh-gradient {
    background: radial-gradient(
      ellipse at top,
      var(--color-primary-50) 0%,
      transparent 60%
    );
    opacity: 0.5;
  }

  .dark .mesh-gradient {
    background: radial-gradient(
      ellipse at top,
      var(--color-primary-950) 0%,
      transparent 60%
    );
    opacity: 0.3;
  }

  /* Developer-focused utilities */
  /* Monospace accent - for code-like elements */
  .mono-accent {
    font-family: 'JetBrains Mono', 'Fira Code', 'Consolas', monospace;
    font-size: 0.9em;
    letter-spacing: -0.02em;
  }

  /* Terminal/console styling */
  .terminal-box {
    background: var(--color-gray-950);
    color: var(--color-gray-100);
    border: 1px solid var(--color-gray-800);
    border-radius: 0.5rem;
    padding: 1.5rem;
    font-family: 'JetBrains Mono', 'Fira Code', 'Consolas', monospace;
    font-size: 0.875rem;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
  }

  .terminal-box::before {
    content: '';
    display: block;
    height: 1.5rem;
    margin: -1.5rem -1.5rem 1rem -1.5rem;
    background: var(--color-gray-900);
    border-bottom: 1px solid var(--color-gray-800);
    border-radius: 0.5rem 0.5rem 0 0;
  }

  /* Sophisticated card with border accent */
  .card-modern {
    background: white;
    border: 1px solid var(--color-gray-200);
    border-radius: 0.75rem;
    padding: 1.5rem;
    transition: all 0.3s ease;
    position: relative;
  }

  .card-modern::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 4px;
    height: 100%;
    background: var(--color-primary-500);
    border-radius: 0.75rem 0 0 0.75rem;
    opacity: 0;
    transition: opacity 0.3s ease;
  }

  .card-modern:hover::before {
    opacity: 1;
  }

  .card-modern:hover {
    border-color: var(--color-primary-300);
    box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.08);
    transform: translateY(-2px);
  }

  .dark .card-modern {
    background: var(--color-gray-900);
    border-color: var(--color-gray-800);
  }

  .dark .card-modern:hover {
    border-color: var(--color-primary-700);
    box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.4);
  }

  /* Geometric accent line */
  .accent-line {
    position: relative;
    padding-left: 1.5rem;
  }

  .accent-line::before {
    content: '';
    position: absolute;
    left: 0;
    top: 0;
    width: 3px;
    height: 100%;
    background: var(--color-primary-500);
  }

  /* Subtle hover glow for interactive elements */
  .hover-glow {
    transition: box-shadow 0.3s ease;
  }

  .hover-glow:hover {
    box-shadow: 0 0 20px rgba(96, 111, 207, 0.15);
  }

  .dark .hover-glow:hover {
    box-shadow: 0 0 20px rgba(96, 111, 207, 0.25);
  }

  /* Grid pattern background - subtle */
  .grid-pattern {
    background-image:
      linear-gradient(var(--color-gray-200) 1px, transparent 1px),
      linear-gradient(90deg, var(--color-gray-200) 1px, transparent 1px);
    background-size: 40px 40px;
  }

  .dark .grid-pattern {
    background-image:
      linear-gradient(var(--color-gray-800) 1px, transparent 1px),
      linear-gradient(90deg, var(--color-gray-800) 1px, transparent 1px);
  }

  /* Text shadow for better readability */
  .text-shadow {
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  }

  .dark .text-shadow {
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
  }
}

.task-list-item::before {
  @apply hidden;
}

.task-list-item {
  @apply list-none;
}

.footnotes {
  @apply mt-12 border-t border-gray-200 pt-8 dark:border-gray-700;
}

.data-footnote-backref {
  @apply no-underline;
}

.csl-entry {
  @apply my-5;
}

.no-scrollbar::-webkit-scrollbar {
  display: none;
}

.no-scrollbar {
  -ms-overflow-style: none; /* IE and Edge */
  scrollbar-width: none; /* Firefox */
}

/* https://stackoverflow.com/questions/61083813/how-to-avoid-internal-autofill-selected-style-to-be-applied */
input:-webkit-autofill,
input:-webkit-autofill:focus {
  transition:
    background-color 600000s 0s,
    color 600000s 0s;
}

.katex-display {
  overflow: auto hidden;
}

.content-header-link {
  opacity: 0;
  margin-left: -24px;
  padding-right: 4px;
}

.content-header:hover .content-header-link,
.content-header-link:hover {
  opacity: 1;
}

.linkicon {
  display: inline-block;
  vertical-align: middle;
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

::-webkit-scrollbar-track {
  background: var(--color-gray-100);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: var(--color-gray-300);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: var(--color-gray-400);
}

.dark ::-webkit-scrollbar-track {
  background: var(--color-gray-900);
}

.dark ::-webkit-scrollbar-thumb {
  background: var(--color-gray-700);
}

.dark ::-webkit-scrollbar-thumb:hover {
  background: var(--color-gray-600);
}
